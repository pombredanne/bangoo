{% extends 'admin/base.html' %}
{% load bootstrap_form_fields %}
{% load crispy_forms_tags %}
{% load i18n %}
{% load navigation_tags %}
{% load static %}

{% block head %}
    {{ block.super }}
    {% comment %}
    <script src="{% static 'admin/js/angular.min.js' %}" type="text/javascript"></script>
    {% endcomment %}
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js" type="text/javascript"></script>
    <script src="{% static 'admin/js/codehouse.ui.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/js/app/content.js' %}" type="text/javascript"></script>

    <script src="{% theme_static 'redactor/redactor.min.js' %}" type="text/javascript"></script>
    <script src="{% theme_static 'redactor/plugins/imagemanager.js' %}" type="text/javascript"></script>
    <link href="{% theme_static 'redactor/redactor.css' %}" rel="stylesheet" type="text/css">
    <style>
    .redactor-editor .easy-block-v1 .easy-block-v1-badge {
        color: #fff;
        left: 0;
        padding: 4px 10px;
        position: absolute;
        top: 10px;
        z-index: 1;
    }

    .ms-container {
        width: 100%;
    }

    .ms-container .ms-selectable, .ms-container .ms-selection {
        width: 49%
    }

    #page-settings .control-label {
        float: left;
        width: 100%
    }

    #page-settings input[type=checkbox] {
        position: absolute;
        right: 30px;
        width: auto;
        height: auto;
    }

    #page-settings input[type=text] {
        display: inline;
    }

    #page-settings .help-block {
        clear: both;
    }

    </style>
{% endblock %}

{% block content %}
    <div ng-app="bangoo.content.edit" ng-cloak>
        <form ng-controller="BangooContentEditController as cf" novalidate action="{% url 'api:content-api' act_menu.pk %}" ng-submit="cf.submit($event)">
            <div class="row col-lg-12">
                {% if form.instance.is_page %}
                    <h1>{{ menu.title }}</h1>
                {% else %}
                    <h1>{% trans 'Edit widget' %}</h1>
                {% endif %}
            </div>
            <div class="col-lg-12 alert alert-danger" role="alert" ng-show="cf.errors.__all__">
                <ul>
                    <li ng-repeat="error in cf.errors.__all__">
                        [[ error ]]
                    </li>
                </ul>
            </div>
            <div class="row">
                <div class="col-lg-9">
                    {% for lang in form.languages %}
                    <div class="panel panel-default">
                        <div class="panel-body">
                            {% redactor_field lang.fields.text 'cf.data.'|add:lang.fields.text.name 'cf.errors.'|add:lang.fields.text.name %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="col-lg-3">
                    <div id="page-settings" class="panel panel-default">
                        <div class="panel-heading">Page settings</div>
                        <div class="panel-body">
                            {% bootstrap_field form.allow_comments 'cf.data.allow_comments' 'cf.errors.allow_comments' %}
                            {% bootstrap_field form.authors 'cf.data.authors' 'cf.errors.authors' %}
                            {% bootstrap_field form.template_name 'cf.data.template_name' 'cf.errors.template_name' %}
                            {% bootstrap_field form.registration_required 'cf.data.registration_required' 'cf.errors.registration_required' %}
                            {% bootstrap_field form.is_page 'cf.data.is_page' 'cf.errors.is_page' %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-actions">
                <input type="submit" name="submit" value="{% trans 'Save' %}" class="btn btn-primary">
            </div>
        </form>
    </div>
{% endblock %}
