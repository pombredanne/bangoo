{% extends 'admin/base.html' %}
{% load bootstrap_form_fields %}
{% load crispy_forms_tags %}
{% load i18n %}
{% load navigation_tags %}
{% load static %}

{% block head %}
    {{ block.super }}
    {% comment %}
    <script src="{% static 'admin/js/angular.min.js' %}" type="text/javascript"></script>
    {% endcomment %}
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js" type="text/javascript"></script>
    <script src="{% static 'admin/js/codehouse.ui.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/js/app/content.js' %}" type="text/javascript"></script>

    <script src="{% theme_static 'redactor/redactor.min.js' %}" type="text/javascript"></script>
    <script src="{% theme_static 'redactor/plugins/imagemanager.js' %}" type="text/javascript"></script>
    <link href="{% theme_static 'redactor/redactor.css' %}" rel="stylesheet" type="text/css">
    <script type="text/javascript">
        $(function() {
            $('textarea').redactor({
                focus: true,
                buttonSource: true,
                paragraphize: false,
                replaceDivs: false,
                plugins: ['imagemanager'],
                imageManagerJson: "{% url 'media-redactor-list-images' %}",
                imageUpload: "{% url  'media-redactor-upload-images' %}"
            });
        });
    </script>
    <style>
    .redactor-editor .easy-block-v1 .easy-block-v1-badge {
        color: #fff;
        left: 0;
        padding: 4px 10px;
        position: absolute;
        top: 10px;
        z-index: 1;
    }
    </style>
{% endblock %}

{% block content %}
    <div ng-app="bangoo.content.edit" ng-cloak>
        <form ng-controller="BangooContentEditController as cf" data-url="{% url 'api:content-api' act_menu.pk %}">
            <div class="row col-lg-12">
                {% if form.instance.is_page %}
                    <h1>{{ menu.title }}</h1>
                {% else %}
                    <h1>{% trans 'Edit widget' %}</h1>
                {% endif %}
            </div>
            <div class="row">
                <div class="col-lg-10">
                    <div class="panel panel-default" ng-repeat="(lang, fields) in cf.data.translations">
                        <div class="panel-heading">[[ lang ]]</div>
                        <div class="panel-body">
                            <bs-input model="fields.title" ></bs-input>
                            <bs-textarea model="fields.text"></bs-textarea>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="panel panel-default">
                        <div class="panel-heading">Page settings</div>
                        <div class="panel-body">
                            {% bootstrap_field form.allow_comments 'cf.data.pageSettings.allowComments' 'cf.errors.allow_comments' %}
                            {% bootstrap_field form.template_name 'cf.data.pageSettings.templateName' 'cf.errors.template_name' %}
                            {% bootstrap_field form.registration_required 'cf.data.pageSettings.registrationRequired' 'cf.errors.registration_required' %}
                            {% bootstrap_field form.is_page 'cf.data.pageSettings.isPage' 'cf.errors.is_page' %}
                        </div>
                    </div>
                </div>
            </div>
            <pre>[[ cf|json ]]</pre>
        </form>
    </div>
{% endblock %}
